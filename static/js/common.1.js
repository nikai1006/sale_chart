var admin_name = '任务调度中心';
var admin_name_full = '分布式任务调度平台JIATUI-JOB';
var admin_version = '1.0.0 (快照版)';

var system_tips = '系统提示';
var system_ok = '确定';
var system_close = '关闭';
var system_save = '保存';
var system_cancel = '取消';
var system_search = '搜索';
var system_status = '状态';
var system_opt = '操作';
var system_please_input = '请输入';
var system_please_choose = '请选择';
var system_success = '成功';
var system_fail = '失败';
var system_add_suc = '新增成功';
var system_add_fail = '新增失败';
var system_update_suc = '更新成功';
var system_update_fail = '更新失败';
var system_all = '全部';
var system_api_error = '接口异常';
var system_show = '查看';
var system_empty = '无';
var system_opt_suc = '操作成功';
var system_opt_fail = '操作失败';
var system_opt_edit = '编辑';
var system_opt_del = '删除';
var system_unvalid = '非法';
var system_not_found = '不存在';
var system_nav = '导航';

var daterangepicker_ranges_recent_hour = '最近一小时';
var daterangepicker_ranges_today = '今日';
var daterangepicker_ranges_yesterday = '昨日';
var daterangepicker_ranges_this_month = '本月';
var daterangepicker_ranges_last_month = '上个月';
var daterangepicker_ranges_recent_week = '最近一周';
var daterangepicker_ranges_recent_month = '最近一月';
var daterangepicker_custom_name = '自定义';
var daterangepicker_custom_starttime = '起始时间';
var daterangepicker_custom_endtime = '结束时间';
var daterangepicker_custom_daysofweek = '日,一,二,三,四,五,六';
var daterangepicker_custom_monthnames = '一月,二月,三月,四月,五月,六月,七月,八月,九月,十月,十一月,十二月';

var dataTable_sProcessing = '处理中...';
var dataTable_sLengthMenu = '每页 _MENU_ 条记录';
var dataTable_sZeroRecords = '没有匹配结果';
var dataTable_sInfo = '第 _PAGE_ 页 ( 总共 _PAGES_ 页，_TOTAL_ 条记录 )';
var dataTable_sInfoEmpty = '无记录';
var dataTable_sInfoFiltered = '(由 _MAX_ 项结果过滤)';
var dataTable_sSearch = '搜索';
var dataTable_sEmptyTable = '表中数据为空';
var dataTable_sLoadingRecords = '载入中...';
var dataTable_sFirst = '首页';
var dataTable_sPrevious = '上页';
var dataTable_sNext = '下页';
var dataTable_sLast = '末页';
var dataTable_sSortAscending = ': 以升序排列此列';
var dataTable_sSortDescending = ': 以降序排列此列';

var login_btn = '登录';
var login_remember_me = '记住密码';
var login_username_placeholder = '请输入登录账号';
var login_password_placeholder = '请输入登录密码';
var login_username_empty = '请输入登录账号';
var login_username_lt_5 = '登录账号不应低于5位';
var login_password_empty = '请输入登录密码';
var login_password_lt_5 = '登录密码不应低于5位';
var login_success = '登录成功';
var login_fail = '登录失败';
var login_param_empty = '账号或密码为空';
var login_param_unvalid = '账号或密码错误';

var logout_btn = '注销';
var logout_confirm = '确认注销登录?';
var logout_success = '注销成功';
var logout_fail = '注销失败';

var job_dashboard_name = '运行报表';
var job_dashboard_job_num = '任务数量';
var job_dashboard_job_num_tip = '调度中心运行的任务数量';
var job_dashboard_trigger_num = '调度次数';
var job_dashboard_trigger_num_tip = '调度中心触发的调度次数';
var job_dashboard_jobgroup_num = '执行器数量';
var job_dashboard_jobgroup_num_tip = '调度中心在线的执行器机器数量';
var job_dashboard_report = '调度报表';
var job_dashboard_report_loaddata_fail = '调度报表数据加载异常';
var job_dashboard_date_report = '日期分布图';
var job_dashboard_rate_report = '成功比例图';
var job_dashboard_group_report = '分类比例图';

var jobinfo_name = '任务管理';
var jobinfo_job = '任务';
var jobinfo_field_add = '新增任务';
var jobinfo_field_update = '更新任务';
var jobinfo_field_id = '任务ID';
var jobinfo_field_jobgroup = '执行器';
var jobinfo_field_jobdesc = '任务描述';
var jobinfo_field_gluetype = '运行模式';
var jobinfo_field_executorparam = '任务参数';
var jobinfo_field_executorparam_err = '任务参数不合法';
var jobinfo_field_cron_unvalid = 'Cron格式非法';
var jobinfo_field_author = '负责人';
var jobinfo_field_alarmemail = '报警邮件';
var jobinfo_field_alarmemail_placeholder = '请输入报警邮件，多个邮件地址则逗号分隔';
var jobinfo_field_alarmemail_error = '报警邮件格式错误，请重新填写';
var jobinfo_field_executorRouteStrategy = '路由策略';
var jobinfo_field_childJobId = '子任务ID';
var jobinfo_field_childJobId_limit = '子任务ID({0})不可与父任务重复';
var jobinfo_field_childJobId_placeholder = '请输入子任务的任务ID,如存在多个则逗号分隔';
var jobinfo_field_executorBlockStrategy = '阻塞处理策略';
var jobinfo_field_executorFailStrategy = '失败处理策略';
var jobinfo_script_location = '脚本位置';
var jobinfo_shard_index = '分片序号';
var jobinfo_shard_total = '分片总数';
var jobinfo_opt_pause = '废弃';
var jobinfo_opt_resume = '启用';
var jobinfo_opt_log = '日志';
var jobinfo_opt_run = '执行';
var jobinfo_glue_remark = '源码备注';
var jobinfo_glue_remark_limit = '源码备注长度限制为4~100';
var jobinfo_glue_rollback = '版本回溯';
var jobinfo_glue_jobid_unvalid = '任务ID非法';
var jobinfo_glue_gluetype_unvalid = '该任务非GLUE模式';

var joblog_name = '调度日志';
var joblog_status = '状态';
var joblog_status_all = '全部';
var joblog_status_suc = '成功';
var joblog_status_fail = '失败';
var joblog_status_running = '进行中';
var joblog_field_triggerTime = '调度时间';
var joblog_field_triggerCode = '调度结果';
var joblog_field_triggerMsg = '调度备注';
var joblog_field_handleTime = '执行时间';
var joblog_field_handleCode = '执行结果';
var joblog_field_handleMsg = '执行备注';
var joblog_field_executorAddress = '执行器地址';
var joblog_clean = '清理';
var joblog_clean_log = '日志清理';
var joblog_clean_type = '清理方式';
var joblog_clean_type_1 = '清理一个月之前日志数据';
var joblog_clean_type_2 = '清理三个月之前日志数据';
var joblog_clean_type_3 = '清理六个月之前日志数据';
var joblog_clean_type_4 = '清理一年之前日志数据';
var joblog_clean_type_5 = '清理一千条以前日志数据';
var joblog_clean_type_6 = '清理一万条以前日志数据';
var joblog_clean_type_7 = '清理三万条以前日志数据';
var joblog_clean_type_8 = '清理十万条以前日志数据';
var joblog_clean_type_9 = '清理所有日志数据';
var joblog_clean_type_unvalid = '清理类型参数异常';
var joblog_handleCode_200 = '成功';
var joblog_handleCode_500 = '失败';
var joblog_handleCode_501 = '失败重试';
var joblog_kill_log = '终止任务';
var joblog_kill_log_limit = '调度失败，无法终止日志';
var joblog_kill_log_byman = '人为操作主动终止';
var joblog_rolling_log = '执行日志';
var joblog_rolling_log_refresh = '刷新';
var joblog_rolling_log_triggerfail = '任务发起调度失败，无法查看执行日志';
var joblog_rolling_log_failoften = '终止请求Rolling日志,请求失败次数超上限,可刷新页面重新加载日志';
var job_help = '使用教程';
var job_help_document = '官方文档';
$(function () {

  /*$("#loadUser").click(function () {
    $.get("/user/get", {username: $("#loadUser").text()}, function (data) {
      if (data.code == 0) {
        var userinfo = data.data;
        var joinTime = userinfo.joinTime;
        var lastTime = joinTime ? moment(new Date(joinTime)).format(
            "YYYY-MM-DD")
            : "";
        $("#joinTime").text(lastTime + "加入");
        $("#userShow").text(userinfo.nickname + "-" + userinfo.role);
      }
    });
  });*/
  $('.img-circle').click(function () {
    // $('#photoModal').modal({backdrop: false, keyboard: true}).modal('show');
  });

  // logout
  $("#logoutBtn").click(function () {
    layer.confirm(logout_confirm, {
      icon: 3,
      title: system_tips,
      btn: [system_ok, system_cancel]
    }, function (index) {
      layer.close(index);

      $.post(base_url + "/logout", function (data, status) {
        if (data.code == 0) {
          layer.msg(logout_success);
          setTimeout(function () {
            window.location.href = "/login";
          }, 500);
        } else {
          layer.open({
            title: system_tips,
            btn: [system_ok],
            content: (data.msg || logout_fail),
            icon: '2'
          });
        }
      });
    });

  });

  $("#settings").click(function () {
    $('#setModal').modal({backdrop: false, keyboard: true}).modal('show');
  });

  var settingsValidate = $("#setModal .form").validate({
    errorElement: 'span',
    errorClass: 'help-block',
    focusInvalid: false,
    rules: {
      username: {
        required: true,
        minlength: 1,
        maxlength: 18
      },
      nickname: {
        required: true,
      },
      email: {
        required: true,
        minlength: 5,
        email: true
      },
      cellphone: {
        required: false,
        digits: true,
        minlength: 11,
        maxlength: 11,
      }
    },
    messages: {
      username: {
        required: '用户名不能为空',
        minlength: '用户名不能小于1位',
        maxlength: '用户名长度不能超过18位'
      },
      nickname: {
        required: '密码不能为空'
      },
      email: {
        required: '不能为空',
        minlength: '长度不能小于5',
        email: '请输入一个正确的邮箱'
      },
      cellphone: {
        digits: "手机号必须为数字",
        minlength: '长度必须为11位',
        maxlength: '长度必须为11位',
      }
    },
    highlight: function (element) {
      $(element).closest('.form-group').addClass('has-error');
    },
    success: function (label) {
      label.closest('.form-group').removeClass('has-error');
      label.remove();
    },
    errorPlacement: function (error, element) {
      element.parent('div').append(error);
    },
    submitHandler: function (form) {
      $.post("/user/settings", $("#setModal .form").serialize(),
          function (data, status) {
            var code = data.code;
            $('#setModal').modal('hide');
            if (code == 0) {
              layer.open({
                title: system_tips,
                btn: [system_ok],
                content: system_update_suc,
                icon: '1',
                end: function (layero, index) {
                  var userInfo = data.data;
                  $("#loadUser").text(userInfo.username);
                  $("#joinTime").text(userInfo.joinTime + "加入");
                  $("#userShow").text(userInfo.nickname + "-" + userInfo.role);
                  $("#setModal .form input[name='username']").val(
                      userInfo.username);
                  $("#setModal .form input[name='nickname']").val(
                      userInfo.nickname);
                  $("#setModal .form input[name='email']").val(userInfo.email);
                  $("#setModal .form input[name='cellphone']").val(
                      userInfo.cellphone);
                  $("#sex").val(userInfo.sex);
                }
              });
            } else if (code == 401) {
              layer.open({
                title: system_tips,
                btn: [system_ok],
                content: ('请重新登录' || system_update_suc),
                icon: '1',
                end: function (layero, index) {
                  setTimeout(function () {
                    window.location.href = "/login";
                  }, 500);
                }
              });
              // layer.msg(system_update_suc+'请重新登录');
            } else {
              layer.open({
                title: system_tips,
                btn: [system_ok],
                content: (data.msg || system_update_fail),
                icon: '2'
              });
            }
          });
    }
  });

  $("#changePassword").click(function () {
    $('#changeModal').modal({backdrop: false, keyboard: true}).modal('show');
  });

  var changeValidate = $("#changeModal .form").validate({
    errorElement: 'span',
    errorClass: 'help-block',
    focusInvalid: false,
    rules: {
      password_old: {
        required: true,
        minlength: 5,
        maxlength: 18
      },
      password: {
        required: true,
        minlength: 5,
        maxlength: 18
      },
      password_again: {
        equalTo: "#password"
      }
    },
    messages: {
      password_old: {
        required: true,
        minlength: 5,
        maxlength: 18
      },
      password: {
        required: '密码不能为空',
        minlength: '密码不能小于5位'
      },
      password_again: {
        equalTo: "两次密码输入不同"
      }
    },
    highlight: function (element) {
      $(element).closest('.form-group').addClass('has-error');
    },
    success: function (label) {
      label.closest('.form-group').removeClass('has-error');
      label.remove();
    },
    errorPlacement: function (error, element) {
      element.parent('div').append(error);
    },
    submitHandler: function (form) {
      var obj = {};
      obj.old = $("#changeModal .form input[name='password_old']").val();
      obj.password = $("#changeModal .form input[name='password']").val();

      $.post("/user-passwd/change", obj,
          function (data, status) {
            if (data.code == 0) {
              $('#changeModal').modal('hide');
              layer.open({
                title: system_tips,
                btn: [system_ok],
                content: system_update_suc,
                icon: '1',
                end: function (layero, index) {
                  console.log("success");
                  setTimeout(function () {
                    window.location.href = "/login";
                  }, 500);
                }
              });
            } else {
              layer.open({
                title: system_tips,
                btn: [system_ok],
                content: (data.msg || system_update_fail),
                icon: '2'
              });
            }
          });
    }
  });

  // slideToTop
  var slideToTop = $("<div />");
  slideToTop.html('<i class="fa fa-chevron-up"></i>');
  slideToTop.css({
    position: 'fixed',
    bottom: '20px',
    right: '25px',
    width: '40px',
    height: '40px',
    color: '#eee',
    'font-size': '',
    'line-height': '40px',
    'text-align': 'center',
    'background-color': '#222d32',
    cursor: 'pointer',
    'border-radius': '5px',
    'z-index': '99999',
    opacity: '.7',
    'display': 'none'
  });
  slideToTop.on('mouseenter', function () {
    $(this).css('opacity', '1');
  });
  slideToTop.on('mouseout', function () {
    $(this).css('opacity', '.7');
  });
  $('.wrapper').append(slideToTop);
  $(window).scroll(function () {
    if ($(window).scrollTop() >= 150) {
      if (!$(slideToTop).is(':visible')) {
        $(slideToTop).fadeIn(500);
      }
    } else {
      $(slideToTop).fadeOut(500);
    }
  });
  $(slideToTop).click(function () {
    $("html,body").animate({		// firefox ie not support body, chrome support body. but found that new version chrome not support body too.
      scrollTop: 0
    }, 100);
  });

});

function logoutconfirm() {
  layer.confirm(logout_confirm, {
    icon: 3,
    title: system_tips,
    btn: [system_ok, system_cancel]
  }, function () {
    return true;
  }, function () {
    return false;
  });
}
